import { Notes, Split, Image } from 'mdx-deck';
import { CodeSurfer, CodeSurferColumns, Step } from 'code-surfer';
import {
  base,
  dracula,
  duotoneDark,
  duotoneLight,
  github,
  nightOwl,
  oceanicNext,
  shadesOfPurple,
  ultramin,
  vsDark,
} from '@code-surfer/themes';
import wrapperHell from './assets/wrapper-hell-NSP.png';

export const theme = nightOwl;

# React Hooks

---

- Why
- What
- How
- When

---

# Why Hooks?

---

<ul>
  <li style={{ margin: 10 }}>JavaScript classes</li>
  <li style={{ margin: 10 }}>Organizing complex components</li>
  <li style={{ margin: 10 }}>Reusing logic</li>
</ul>

---

# JavaScript classes

<Notes>

- JavaScript classes can be confusing
  - `this` is not intuitive
- React components are conceptually more similar to functions

</Notes>

---

<CodeSurfer>

```js file=./code/ClassComponent.bind.js
```

```js file=./code/ClassComponent.classProperties.js
```

</CodeSurfer>

---

# Organizing complex components

<Notes>

- Related code gets split between lifecycle hooks

</Notes>

---

<CodeSurfer>

```js file=./code/ComplexComponent.js
```

```js 3,20 file=./code/ComplexComponent.js
```

```js 7,12 file=./code/ComplexComponent.js
```

```js 8,16 file=./code/ComplexComponent.js
```

```js file=./code/ComplexComponent.js
```

</CodeSurfer>

---

# Reusing logic

<Notes>

- Currently done with HOC's (or render props, though those aren't used much in NSP)
  - Not clear where props are coming from
  - Adds new component to tree - clutters React DevTools
  - Prop collisions (though rare) are possible

</Notes>

---

# Higher-Order Components

<Notes>

- HOCs are functions that take in a base component and return an "enhanced" version of that component, often injecting new props into the base component
- Can be hard to know where props are actually coming from in the base component
- Because they create new components in the render tree, they can clutter the DevTools, leading to...

</Notes>

---

<CodeSurferColumns>

<Step>

```js file=./code/Checkbox.base.js
```

```js file=./code/Accordion.base.js
```

</Step>

<Step>

```js 2:6 file=./code/Checkbox.base.js
```

```js 2:6 file=./code/Accordion.base.js
```

</Step>

</CodeSurferColumns>

---

<CodeSurfer>

```js file=./code/WithToggle.js
```

```js 3:7 file=./code/WithToggle.js
```

```js 13:14 file=./code/WithToggle.js
```

</CodeSurfer>

---

<CodeSurferColumns>

<Step>

```js file=./code/Checkbox.base.js
```

```js file=./code/Accordion.base.js
```

</Step>

<Step>

```js file=./code/Checkbox.withHOC.js
```

```js file=./code/Accordion.withHOC.js
```

</Step>

<Step>

```js 4[1] file=./code/Checkbox.withHOC.js
```

```js 4[24:37],5[10:20],7[8:18,21:35] file=./code/Accordion.withHOC.js
```

</Step>

</CodeSurferColumns>

---

<Image src={wrapperHell} size="contain" />

---

# What are Hooks?

---

<CodeSurfer>

```js file=./code/ProductBuilder.class.basic.0.js
```

</CodeSurfer>

---

<CodeSurferColumns sizes={[1,2]}>

<Step>

```js file=./code/ProductBuilder.class.basic.0.js
```

```js file=./code/ProductBuilder.class.basic.0.js
```

</Step>

<Step>

```js file=./code/ProductBuilder.class.basic.0.js
```

```js file=./code/ProductBuilder.hooks.basic.0.js
```

</Step>

<Step>

```js 3,15 file=./code/ProductBuilder.class.basic.0.js
```

```js file=./code/ProductBuilder.hooks.basic.1.js
```

</Step>

<Step>

```js 6:9,16 file=./code/ProductBuilder.class.basic.0.js
```

```js file=./code/ProductBuilder.hooks.basic.2.js
```

</Step>

<Step>

```js
// Array destructuring

const array = ['Hello', 'world'];

// this...
const hello = array[0];
const world = array[1];

// ...is the same as this
const [hello, world] = array;
```

```js file=./code/ProductBuilder.hooks.basic.3.js
```

</Step>

<Step>

```js file=./code/ProductBuilder.class.basic.0.js
```

```js 2 file=./code/ProductBuilder.hooks.basic.3.js
```

</Step>

<Step>

```js file=./code/ProductBuilder.class.basic.0.js
```

```js file=./code/ProductBuilder.hooks.basic.4.js
```

</Step>

<Step>

```js file=./code/ProductBuilder.class.basic.0.js
```

```js file=./code/ProductBuilder.hooks.basic.4.js
```

</Step>

<Step subtitle="Create a state value and give it a name">

```js 3[5:8] file=./code/ProductBuilder.class.basic.0.js
```

```js 2[10:13] file=./code/ProductBuilder.hooks.basic.4.js
```

</Step>

<Step subtitle="Set the initial value">

```js 3[11:19] file=./code/ProductBuilder.class.basic.0.js
```

```js 2[42:50] file=./code/ProductBuilder.hooks.basic.4.js
```

</Step>

<Step subtitle="Update the state value">

```js 7 file=./code/ProductBuilder.class.basic.0.js
```

```js 2[16:22],5 file=./code/ProductBuilder.hooks.basic.4.js
```

</Step>

</CodeSurferColumns>

---

<CodeSurfer>

```js file=./code/ProductBuilder.class.basic.0.js title="Adding multiple state values"
```

```js file=./code/ProductBuilder.class.multipleState.0.js
```

</CodeSurfer>

---

<CodeSurferColumns sizes={[1,2]}>

<Step>

```js file=./code/ProductBuilder.class.multipleState.0.js
```

```js file=./code/ProductBuilder.hooks.basic.4.js
```

</Step>

<Step>

```js 4,11:13,23:27 file=./code/ProductBuilder.class.multipleState.0.js
```

```js file=./code/ProductBuilder.hooks.multipleState.0.js
```

</Step>

</CodeSurferColumns>

---

<CodeSurfer>

```js file=./code/ProductBuilder.class.multipleState.0.js title="Performing side effects"
```

```js file=./code/ProductBuilder.class.documentTitle.0.js
```

```js file=./code/ProductBuilder.class.documentTitle.1.js
```

</CodeSurfer>

---

<CodeSurferColumns sizes={[1,2]}>

<Step>

```js file=./code/ProductBuilder.class.documentTitle.1.js
```

```js file=./code/ProductBuilder.hooks.multipleState.0.js
```

</Step>

<Step>

```js 7:13 file=./code/ProductBuilder.class.documentTitle.1.js
```

```js file=./code/ProductBuilder.hooks.documentTitle.0.js
```

</Step>

</CodeSurferColumns>

---

<CodeSurfer>

```js file=./code/ProductBuilder.class.documentTitle.1.js title="Subscribing and unsubscribing"
```

```js file=./code/ProductBuilder.class.windowWidth.0.js
```

```js file=./code/ProductBuilder.class.windowWidth.1.js
```

```js file=./code/ProductBuilder.class.windowWidth.2.js
```

</CodeSurfer>

---

<CodeSurferColumns sizes={[1,2]}>

<Step>

```js file=./code/ProductBuilder.class.windowWidth.2.js
```

```js file=./code/ProductBuilder.hooks.documentTitle.0.js
```

</Step>

<Step>

```js 5,46 file=./code/ProductBuilder.class.windowWidth.2.js
```

```js file=./code/ProductBuilder.hooks.windowWidth.0.js
```

</Step>

<Step>

```js 8,10:11,21:23 file=./code/ProductBuilder.class.windowWidth.2.js
```

```js file=./code/ProductBuilder.hooks.windowWidth.1.js
```

</Step>

<Step>

```js 17:19 file=./code/ProductBuilder.class.windowWidth.2.js
```

```js file=./code/ProductBuilder.hooks.windowWidth.2.js
```

</Step>

</CodeSurferColumns>

---

<CodeSurfer>

```js file=./code/ProductBuilder.class.windowWidth.2.js title="Optimizing side effects"
```

```js 13:15 file=./code/ProductBuilder.class.windowWidth.2.js
```

```js file=./code/ProductBuilder.class.optimizeEffects.0.js
```

</CodeSurfer>

---

<CodeSurferColumns sizes={[1,2]}>

<Step>

```js file=./code/ProductBuilder.class.optimizeEffects.0.js
```

```js file=./code/ProductBuilder.hooks.windowWidth.2.js
```

</Step>

<Step>

```js 13:17 file=./code/ProductBuilder.class.optimizeEffects.0.js
```

```js 5:7 file=./code/ProductBuilder.hooks.optimizeEffects.0.js
```

</Step>

<Step>

```js 14 file=./code/ProductBuilder.class.optimizeEffects.0.js
```

```js file=./code/ProductBuilder.hooks.optimizeEffects.1.js
```

</Step>

</CodeSurferColumns>

---

<ul>
  <li style={{ margin: 10 }}>JavaScript classes</li>
  <li style={{ margin: 10 }}>Organizing complex components</li>
  <li style={{ margin: 10 }}>Reusing logic</li>
</ul>

---

<CodeSurferColumns sizes={[1,2]}>

<Step>

```js file=./code/ProductBuilder.class.windowWidth.2.js
```

```js file=./code/ProductBuilder.hooks.windowWidth.2.js
```

</Step>

<Step>

```js 5,8,10:11,17:23 file=./code/ProductBuilder.class.windowWidth.2.js
```

```js file=./code/ProductBuilder.hooks.windowWidth.2.js
```

</Step>

<Step>

```js 5,8,10:11,17:23 file=./code/ProductBuilder.class.windowWidth.2.js
```

```js 9:16 file=./code/ProductBuilder.hooks.windowWidth.2.js
```

</Step>

</CodeSurferColumns>

---

<ul>
  <li style={{ margin: 10 }}>JavaScript classes</li>
  <li style={{ margin: 10 }}>Organizing complex components</li>
  <li style={{ margin: 10 }}>Reusing logic</li>
</ul>

---

<CodeSurfer>

```js 9:16 file=./code/ProductBuilder.hooks.windowWidth.2.js
```

```js 1:10 file=./code/ProductBuilder.hooks.customHook.0.js
```

```js file=./code/ProductBuilder.hooks.customHook.1.js
```

```js file=./code/ProductBuilder.hooks.customHook.2.js
```

```js 1:11,16 file=./code/ProductBuilder.hooks.customHook.2.js
```

</CodeSurfer>

---

- `useReducer`
- `useContext`
- `useRef`
- `useCallback`

---

# How do Hooks work?

<Notes>

- Can't call Hooks instead class components
- Rules of Hooks (rely on call order)
- Hooks start with "use"

</Notes>

---

<h1 style={{ textAlign: 'center' }}>
Only call Hooks from React functions
</h1>

- Function components
- Custom Hooks (like `useWindowWidth`)

---

<CodeSurfer>

```js 18:23 file=./code/ProductBuilder.hooks.breakingRules.0.js subtitle="Hooks must be called at the top level"
```

```js file=./code/ProductBuilder.hooks.breakingRules.1.js
```

</CodeSurfer>

---

<CodeSurfer>

```js 1:11,16 file=./code/ProductBuilder.hooks.customHook.2.js
```

```js 1[7:9],16[17:19] file=./code/ProductBuilder.hooks.customHook.2.js subtitle="Custom Hooks must start with 'use'"
```

</CodeSurfer>

---

# When to use Hooks?

---

<h1>
  <a href="https://confluence.viator.com/display/EN/Using+React+Hooks+in+NSP">
    Using React Hooks in NSP
  </a>
</h1>

---

<h1>
  <a href="https://reactjs.org/docs/hooks-intro.html">React Docs</a>
</h1>
